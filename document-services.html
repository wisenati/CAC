<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CAC Nigeria - Document Services</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-storage-compat.js"></script>
    <style>
      :root {
        --primary-green: #1e5f3e;
        --secondary-green: #2d7a52;
        --accent-gold: #d4af37;
        --light-gold: #f4e8a0;
        --white: #ffffff;
        --gray-100: #f8f9fa;
        --gray-200: #e9ecef;
        --gray-300: #dee2e6;
        --gray-800: #343a40;
        --shadow-light: 0 2px 10px rgba(0, 0, 0, 0.1);
        --shadow-medium: 0 4px 25px rgba(0, 0, 0, 0.15);
        --shadow-heavy: 0 8px 40px rgba(0, 0, 0, 0.2);
        --gradient-primary: linear-gradient(135deg, #1e5f3e 0%, #2d7a52 100%);
        --gradient-accent: linear-gradient(135deg, #d4af37 0%, #f4e8a0 100%);
        --gradient-card: linear-gradient(145deg, #ffffff 0%, #f8f9fa 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        line-height: 1.6;
        color: var(--gray-800);
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* App-like Header */
      .app-header {
        position: fixed;
        top: 0;
        width: 100%;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        z-index: 1000;
        padding: 1rem 0;
        box-shadow: var(--shadow-light);
        border-bottom: 1px solid var(--gray-200);
      }

      .header-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .logo-section {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .logo-section img {
        height: 45px;
        width: auto;
        filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.1));
      }

      .logo-text {
        font-size: 1.4rem;
        font-weight: 700;
        color: var(--primary-green);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .notification-btn,
      .profile-btn {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        border: none;
        background: var(--gradient-accent);
        color: var(--primary-green);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.1rem;
        transition: all 0.3s ease;
        box-shadow: var(--shadow-light);
      }

      .notification-btn:hover,
      .profile-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
      }

      /* Main Content */
      .main-content {
        max-width: 1200px;
        margin: 100px auto 40px;
        padding: 0 20px;
      }

      .page-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .page-title {
        font-size: 2.2rem;
        font-weight: 700;
        color: var(--primary-green);
        margin-bottom: 0.5rem;
      }

      .page-subtitle {
        font-size: 1.1rem;
        color: var(--gray-800);
        opacity: 0.8;
      }

      /* Document Services Section */
      .document-section {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: var(--shadow-light);
        margin-bottom: 2rem;
      }

      .section-title {
        font-size: 1.5rem;
        color: var(--primary-green);
        margin-bottom: 1.5rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid var(--gray-200);
      }

      /* Document Search */
      .document-search {
        display: flex;
        gap: 1rem;
        margin-bottom: 1.5rem;
      }

      #documentSearch {
        flex: 1;
      }

      .search-btn {
        background: var(--gradient-primary);
        color: white;
        border: none;
        padding: 0 1.5rem;
        border-radius: 8px;
        cursor: pointer;
      }

      /* Document Categories */
      .document-categories {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .category-card {
        border: 1px solid var(--gray-200);
        border-radius: 15px;
        padding: 1.5rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: center;
      }

      .category-card:hover {
        border-color: var(--primary-green);
        transform: translateY(-3px);
        box-shadow: var(--shadow-light);
      }

      .category-card.selected {
        border-color: var(--primary-green);
        background: rgba(30, 95, 62, 0.05);
      }

      .category-icon {
        font-size: 2rem;
        color: var(--primary-green);
        margin-bottom: 1rem;
      }

      .category-title {
        font-weight: 700;
        margin-bottom: 0.5rem;
      }

      /* Document List */
      .document-list {
        margin-top: 2rem;
        display: none;
      }

      .document-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        border: 1px solid var(--gray-200);
        border-radius: 10px;
        margin-bottom: 1rem;
        transition: all 0.3s ease;
        background: var(--gradient-card);
      }

      .document-item:hover {
        box-shadow: var(--shadow-light);
        transform: translateY(-2px);
      }

      .document-info {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex: 1;
      }

      .document-icon {
        font-size: 2rem;
        color: var(--primary-green);
        width: 60px;
        text-align: center;
      }

      .document-details {
        flex: 1;
      }

      .document-name {
        font-weight: 700;
        font-size: 1.1rem;
        margin-bottom: 0.5rem;
      }

      .document-meta {
        display: flex;
        gap: 1rem;
        font-size: 0.9rem;
        color: var(--gray-800);
        opacity: 0.7;
      }

      .document-date {
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .document-size {
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .document-status {
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      .status-badge {
        padding: 0.2rem 0.6rem;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .status-available {
        background: #d4edda;
        color: #155724;
      }

      .status-pending {
        background: #fff3cd;
        color: #856404;
      }

      /* Document Actions */
      .document-actions {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
        align-items: flex-end;
      }

      .document-price {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--primary-green);
        margin-bottom: 0.5rem;
      }

      .action-btn {
        background: var(--gradient-accent);
        color: var(--primary-green);
        border: none;
        padding: 0.6rem 1.2rem;
        border-radius: 20px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
      }

      .action-btn:hover {
        transform: translateX(-3px);
        box-shadow: var(--shadow-medium);
      }

      .action-btn:disabled {
        background: var(--gray-200);
        color: var(--gray-800);
        cursor: not-allowed;
        transform: none;
      }

      .preview-btn {
        background: var(--gradient-primary);
        color: white;
        margin-bottom: 0.5rem;
      }

      .preview-btn:hover {
        background: var(--secondary-green);
      }

      /* Payment Modal */
      .payment-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 2000;
      }

      .payment-modal-content {
        background: white;
        border-radius: 15px;
        padding: 2rem;
        max-width: 500px;
        width: 90%;
        max-height: 80vh;
        overflow-y: auto;
        position: relative;
      }

      .modal-close {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: none;
        border: none;
        font-size: 1.5rem;
        cursor: pointer;
        color: var(--gray-800);
      }

      .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--primary-green);
        margin-bottom: 1rem;
        text-align: center;
      }

      .payment-details {
        background: var(--gray-100);
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .payment-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
      }

      .payment-total {
        border-top: 2px solid var(--primary-green);
        padding-top: 0.5rem;
        font-weight: 700;
        font-size: 1.1rem;
      }

      .bank-transfer-details {
        background: var(--gray-100);
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .bank-detail {
        display: flex;
        margin-bottom: 0.8rem;
      }

      .bank-detail-label {
        font-weight: 600;
        min-width: 120px;
      }

      /* No Documents Message */
      .no-documents {
        text-align: center;
        padding: 3rem 2rem;
        color: var(--gray-800);
        opacity: 0.7;
        display: none;
      }

      .no-documents-icon {
        font-size: 4rem;
        color: var(--gray-300);
        margin-bottom: 1rem;
      }

      /* Action Buttons */
      .action-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 2rem;
      }

      .btn {
        padding: 0.8rem 1.5rem;
        border-radius: 25px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .btn-primary {
        background: var(--gradient-primary);
        color: white;
      }

      .btn-primary:hover {
        transform: translateX(5px);
        box-shadow: var(--shadow-medium);
      }

      .btn-secondary {
        background: var(--gray-200);
        color: var(--gray-800);
      }

      .btn-secondary:hover {
        background: var(--gray-300);
      }

      .btn-accent {
        background: var(--gradient-accent);
        color: var(--primary-green);
      }

      .btn-accent:hover {
        box-shadow: var(--shadow-medium);
      }

      .btn-block {
        width: 100%;
        justify-content: center;
      }

      /* Footer */
      .app-footer {
        background: var(--primary-green);
        color: var(--white);
        padding: 2rem 0;
        text-align: center;
      }

      .footer-content {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Responsive Design */
      @media (max-width: 768px) {
        .header-content {
          padding: 0 15px;
        }

        .logo-text {
          font-size: 1.2rem;
        }

        .main-content {
          margin-top: 80px;
          padding: 0 15px;
        }

        .page-title {
          font-size: 1.8rem;
        }

        .document-search {
          flex-direction: column;
        }

        .document-item {
          flex-direction: column;
          align-items: flex-start;
          gap: 1rem;
        }

        .document-actions {
          align-self: stretch;
          flex-direction: row;
          justify-content: space-between;
        }

        .payment-modal-content {
          margin: 1rem;
          width: calc(100% - 2rem);
        }
      }

      @media (max-width: 480px) {
        .action-buttons {
          flex-direction: column;
          gap: 1rem;
        }

        .btn {
          width: 100%;
          justify-content: center;
        }

        .document-categories {
          grid-template-columns: 1fr;
        }

        .document-meta {
          flex-direction: column;
          gap: 0.5rem;
        }
      }
    </style>
  </head>
  <body>
    <!-- App Header -->
    <header class="app-header">
      <div class="header-content">
        <div class="logo-section">
          <img
            src="https://th.bing.com/th/id/OIP.BYD329vkS6TICObJPDFTPAHaHa?rs=1&pid=ImgDetMain"
            alt="CAC Logo"
          />
          <span class="logo-text">CAC Nigeria</span>
        </div>
        <div class="header-actions">
          <button class="notification-btn" onclick="showNotifications()">
            <i class="fas fa-bell"></i>
            <span class="notification-badge">3</span>
          </button>
          <button class="profile-btn" onclick="showProfile()">
            <i class="fas fa-user"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <h1 class="page-title">Document Services</h1>
        <p class="page-subtitle">
          Access and download your business registration documents and
          certificates
        </p>
      </div>

      <!-- Document Services Section -->
      <div class="document-section">
        <h2 class="section-title">Your Documents</h2>

        <div class="document-search">
          <input
            type="text"
            id="documentSearch"
            class="form-control"
            placeholder="Search for documents by name or reference number"
          />
          <button class="search-btn" onclick="searchDocuments()">
            <i class="fas fa-search"></i> Search
          </button>
        </div>

        <div class="document-categories">
          <div
            class="category-card selected"
            onclick="selectDocumentCategory(this, 'all')"
          >
            <div class="category-icon">
              <i class="fas fa-folder-open"></i>
            </div>
            <h3 class="category-title">All Documents</h3>
            <p>View all available documents</p>
          </div>

          <div
            class="category-card"
            onclick="selectDocumentCategory(this, 'certificates')"
          >
            <div class="category-icon">
              <i class="fas fa-certificate"></i>
            </div>
            <h3 class="category-title">Certificates</h3>
            <p>Registration certificates</p>
          </div>

          <div
            class="category-card"
            onclick="selectDocumentCategory(this, 'returns')"
          >
            <div class="category-icon">
              <i class="fas fa-file-invoice"></i>
            </div>
            <h3 class="category-title">Annual Returns</h3>
            <p>Filed annual returns</p>
          </div>

          <div
            class="category-card"
            onclick="selectDocumentCategory(this, 'forms')"
          >
            <div class="category-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <h3 class="category-title">Forms</h3>
            <p>Submitted application forms</p>
          </div>
        </div>

        <!-- All Documents -->
        <div class="document-list" id="allDocuments">
          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-certificate"></i>
              </div>
              <div class="document-details">
                <div class="document-name">CAC Certificate of Registration</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Issued: 15 Jan 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 2.1 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦2,000</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('cert-reg')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('cert-reg', 2000)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>

          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-file-alt"></i>
              </div>
              <div class="document-details">
                <div class="document-name">CAC Form CAC1.1</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Issued: 15 Jan 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 1.8 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦1,500</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('form-cac1')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('form-cac1', 1500)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>

          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-id-card"></i>
              </div>
              <div class="document-details">
                <div class="document-name">Tax Identification Number</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Issued: 16 Jan 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 1.2 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦1,000</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('tin')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('tin', 1000)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>
        </div>

        <!-- Certificates Documents -->
        <div
          class="document-list"
          id="certificatesDocuments"
          style="display: none"
        >
          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-certificate"></i>
              </div>
              <div class="document-details">
                <div class="document-name">CAC Certificate of Registration</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Issued: 15 Jan 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 2.1 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦2,000</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('cert-reg')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('cert-reg', 2000)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>
        </div>

        <!-- Returns Documents -->
        <div class="document-list" id="returnsDocuments" style="display: none">
          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-file-invoice"></i>
              </div>
              <div class="document-details">
                <div class="document-name">Annual Return 2024</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Filed: 10 Mar 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 1.5 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦1,200</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('ar-2024')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('ar-2024', 1200)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>
        </div>

        <!-- Forms Documents -->
        <div class="document-list" id="formsDocuments" style="display: none">
          <div class="document-item">
            <div class="document-info">
              <div class="document-icon">
                <i class="fas fa-file-alt"></i>
              </div>
              <div class="document-details">
                <div class="document-name">CAC Form CAC1.1</div>
                <div class="document-meta">
                  <div class="document-date">
                    <i class="fas fa-calendar"></i>
                    <span>Issued: 15 Jan 2025</span>
                  </div>
                  <div class="document-size">
                    <i class="fas fa-file"></i>
                    <span>PDF, 1.8 MB</span>
                  </div>
                  <div class="document-status">
                    <span class="status-badge status-available">Available</span>
                  </div>
                </div>
              </div>
            </div>
            <div class="document-actions">
              <div class="document-price">₦1,500</div>
              <button
                class="action-btn preview-btn"
                onclick="previewDocument('form-cac1')"
              >
                <i class="fas fa-eye"></i> Preview
              </button>
              <button
                class="action-btn"
                onclick="initiateDownload('form-cac1', 1500)"
              >
                <i class="fas fa-download"></i> Download
              </button>
            </div>
          </div>
        </div>

        <div class="no-documents" id="noDocuments">
          <div class="no-documents-icon">
            <i class="fas fa-folder-open"></i>
          </div>
          <h3>No documents found</h3>
          <p>You don't have any documents in this category yet</p>
        </div>

        <div class="action-buttons">
          <button
            class="btn btn-secondary"
            onclick="window.location.href='service.html'"
          >
            <i class="fas fa-arrow-left"></i> Back to Services
          </button>
          <button class="btn btn-accent" onclick="requestCertifiedCopies()">
            <i class="fas fa-file-signature"></i> Request Certified Copies
          </button>
        </div>
      </div>
    </main>

    <!-- Payment Modal -->
    <div class="payment-modal" id="paymentModal">
      <div class="payment-modal-content">
        <button class="modal-close" onclick="closePaymentModal()">
          <i class="fas fa-times"></i>
        </button>

        <h3 class="modal-title">Document Download Payment</h3>

        <div class="payment-details">
          <div class="payment-item">
            <span>Document:</span>
            <span id="paymentDocumentName">-</span>
          </div>
          <div class="payment-item">
            <span>Download Fee:</span>
            <span id="paymentDocumentPrice">-</span>
          </div>
          <div class="payment-item">
            <span>Processing Fee:</span>
            <span>₦100</span>
          </div>
          <div class="payment-item payment-total">
            <span>Total Amount:</span>
            <span id="paymentTotalAmount">-</span>
          </div>
        </div>

        <div class="bank-transfer-details">
          <h4>Bank Transfer Details</h4>
          <p>Please transfer the exact amount to the account below:</p>

          <div class="bank-detail">
            <span class="bank-detail-label">Bank Name:</span>
            <span>Palmpay</span>
          </div>
          <div class="bank-detail">
            <span class="bank-detail-label">Account Name:</span>
            <span>ALRAHUZ</span>
          </div>
          <div class="bank-detail">
            <span class="bank-detail-label">Account Number:</span>
            <span>6661855506</span>
          </div>
          <div class="bank-detail">
            <span class="bank-detail-label">Reference:</span>
            <span id="paymentReference">-</span>
          </div>
        </div>

        <div class="payment-proof">
          <h4>Upload Payment Proof</h4>
          <p>After making the transfer, upload your payment receipt:</p>

          <div
            class="file-upload"
            onclick="document.getElementById('paymentProofFile').click()"
          >
            <div class="file-upload-icon">
              <i class="fas fa-file-upload"></i>
            </div>
            <div class="file-upload-text">
              <p>Click to upload payment receipt</p>
              <p><small>(JPEG, PNG or PDF, max 2MB)</small></p>
            </div>
            <span id="paymentProofFileName"></span>
          </div>
          <input
            type="file"
            id="paymentProofFile"
            accept=".jpg,.jpeg,.png,.pdf"
            style="display: none"
            onchange="handlePaymentProofUpload(this)"
          />
        </div>

        <div class="action-buttons">
          <button class="btn btn-secondary" onclick="closePaymentModal()">
            Cancel
          </button>
          <button
            class="btn btn-primary btn-block"
            id="submitPaymentProofBtn"
            onclick="submitPaymentProof()"
            disabled
          >
            <i class="fas fa-check-circle"></i> Submit Payment Proof
          </button>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
      <div class="footer-content">
        <p>
          &copy; 2025 Corporate Affairs Commission Nigeria. All rights reserved.
        </p>
      </div>
    </footer>

    <script>
      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyDJP2XIR51qGTLINiKvEoscYTMt11CaZ5s",
        authDomain: "paytrust-71e30.firebaseapp.com",
        databaseURL: "https://paytrust-71e30-default-rtdb.firebaseio.com/",
        projectId: "paytrust-71e30",
        storageBucket: "paytrust-71e30.appspot.com",
        messagingSenderId: "492609516838",
        appId: "1:492609516838:android:5a924ad3b7e8e508fa3de7",
      };

      // Initialize Firebase
      firebase.initializeApp(firebaseConfig);
      const database = firebase.database();
      const storage = firebase.storage();
      const documentsRef = database.ref("userDocuments");
      const downloadPaymentsRef = database.ref("downloadPayments");

      // Current document category and payment data
      let currentCategory = "all";
      let currentPaymentData = {};

      // Document data with pricing
      const documentPricing = {
        "cert-reg": { name: "CAC Certificate of Registration", price: 2000 },
        "form-cac1": { name: "CAC Form CAC1.1", price: 1500 },
        tin: { name: "Tax Identification Number", price: 1000 },
        "ar-2024": { name: "Annual Return 2024", price: 1200 },
      };

      // Function to select document category
      function selectDocumentCategory(element, category) {
        document.querySelectorAll(".category-card").forEach((card) => {
          card.classList.remove("selected");
        });
        element.classList.add("selected");
        currentCategory = category;

        // Hide all document lists
        document.querySelectorAll(".document-list").forEach((list) => {
          list.style.display = "none";
        });
        document.getElementById("noDocuments").style.display = "none";

        // Show selected category's documents or no documents message
        if (category === "all") {
          document.getElementById("allDocuments").style.display = "block";
        } else {
          const categoryList = document.getElementById(`${category}Documents`);
          if (categoryList && categoryList.children.length > 0) {
            categoryList.style.display = "block";
          } else {
            document.getElementById("noDocuments").style.display = "block";
          }
        }
      }

      // Function to search documents
      function searchDocuments() {
        const searchTerm = document
          .getElementById("documentSearch")
          .value.toLowerCase();
        if (!searchTerm) {
          alert("Please enter a search term");
          return;
        }

        // Get all document items in the current category
        const documentItems =
          currentCategory === "all"
            ? document.querySelectorAll("#allDocuments .document-item")
            : document.querySelectorAll(
                `#${currentCategory}Documents .document-item`
              );

        let found = false;

        documentItems.forEach((item) => {
          const docName = item
            .querySelector(".document-name")
            .textContent.toLowerCase();
          if (docName.includes(searchTerm)) {
            item.style.display = "flex";
            found = true;
          } else {
            item.style.display = "none";
          }
        });

        if (!found) {
          alert("No matching documents found");
        }
      }

      // Function to preview document
      function previewDocument(docId) {
        // In a real app, this would show a preview modal or open the document in a new tab
        alert(
          `Preview for document: ${
            documentPricing[docId]?.name || docId
          }\n\nThis would show a preview of the document without allowing download.`
        );
      }

      // Function to initiate download payment
      function initiateDownload(docId, price) {
        const docInfo = documentPricing[docId];
        if (!docInfo) {
          alert("Document information not found");
          return;
        }

        // Set up payment data
        currentPaymentData = {
          documentId: docId,
          documentName: docInfo.name,
          price: price,
          processingFee: 100,
          totalAmount: price + 100,
          reference: generatePaymentReference(),
          userId: JSON.parse(localStorage.getItem("cacUser"))?.email || "guest",
          timestamp: Date.now(),
        };

        // Update modal content
        document.getElementById("paymentDocumentName").textContent =
          docInfo.name;
        document.getElementById(
          "paymentDocumentPrice"
        ).textContent = `₦${price.toLocaleString()}`;
        document.getElementById(
          "paymentTotalAmount"
        ).textContent = `₦${currentPaymentData.totalAmount.toLocaleString()}`;
        document.getElementById("paymentReference").textContent =
          currentPaymentData.reference;

        // Show payment modal
        document.getElementById("paymentModal").style.display = "flex";
      }

      // Generate payment reference
      function generatePaymentReference() {
        const randomNum = Math.floor(1000 + Math.random() * 9000);
        return `DOC-${new Date().getFullYear()}-${randomNum}`;
      }

      // Close payment modal
      function closePaymentModal() {
        document.getElementById("paymentModal").style.display = "none";
        // Reset form
        document.getElementById("paymentProofFile").value = "";
        document.getElementById("paymentProofFileName").textContent = "";
        document.getElementById("submitPaymentProofBtn").disabled = true;
      }

      // Handle payment proof upload
      function handlePaymentProofUpload(input) {
        const file = input.files[0];
        if (file) {
          // Check file size (max 2MB)
          if (file.size > 2 * 1024 * 1024) {
            alert("File size should not exceed 2MB");
            return;
          }

          // Display file name
          document.getElementById("paymentProofFileName").textContent =
            file.name;
          currentPaymentData.paymentProof = file.name;

          // Enable submit button
          document.getElementById("submitPaymentProofBtn").disabled = false;
        }
      }

      // Submit payment proof
      function submitPaymentProof() {
        if (!currentPaymentData.paymentProof) {
          alert("Please upload payment proof first");
          return;
        }

        // Show loading state
        const btn = document.getElementById("submitPaymentProofBtn");
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
        btn.disabled = true;

        // Save payment data to Firebase
        const paymentData = {
          ...currentPaymentData,
          status: "pending",
          paymentDate: new Date().toISOString(),
        };

        downloadPaymentsRef
          .push()
          .set(paymentData)
          .then(() => {
            alert(
              "Payment proof submitted successfully! Your download will be available once payment is verified (typically within 1-2 hours)."
            );
            closePaymentModal();

            // In a real app, you would check payment status periodically
            // For demo purposes, we'll simulate approval after a delay
            setTimeout(() => {
              simulatePaymentApproval(currentPaymentData.documentId);
            }, 10000); // 10 seconds for demo
          })
          .catch((error) => {
            console.error("Error saving payment data:", error);
            alert("An error occurred. Please try again.");
            btn.innerHTML =
              '<i class="fas fa-check-circle"></i> Submit Payment Proof';
            btn.disabled = false;
          });
      }

      // Simulate payment approval and enable download
      function simulatePaymentApproval(docId) {
        // In a real app, this would be done by admin verification
        alert(
          `Payment approved! You can now download ${
            documentPricing[docId]?.name || docId
          }`
        );

        // Enable actual download
        enableDocumentDownload(docId);
      }

      // Enable document download after payment approval
      function enableDocumentDownload(docId) {
        // Find the document item and update the download button
        const documentItems = document.querySelectorAll(".document-item");
        documentItems.forEach((item) => {
          const downloadBtn = item.querySelector(`[onclick*="${docId}"]`);
          if (downloadBtn && downloadBtn.textContent.includes("Download")) {
            downloadBtn.innerHTML =
              '<i class="fas fa-download"></i> Download Now';
            downloadBtn.onclick = () => actuallyDownloadDocument(docId);
            downloadBtn.style.background = "var(--gradient-primary)";
            downloadBtn.style.color = "white";
          }
        });
      }

      // Actually download the document (after payment)
      function actuallyDownloadDocument(docId) {
        const docInfo = documentPricing[docId];
        alert(`Downloading ${docInfo?.name || docId}...\n\nLoading.`);

        // In a real app, you would:
        // 1. Verify payment status in Firebase
        // 2. Generate a secure download URL from Firebase Storage
        // 3. Trigger the actual file download
        // 4. Log the download activity

        // Simulate download
        setTimeout(() => {
          alert("Download completed successfully!");
        }, 2000);
      }

      // Function to request certified copies
      function requestCertifiedCopies() {
        alert("Redirecting to certified copies request form...\n\nloading.");
        // In a real app, this would navigate to a request form
      }

      // Functions from service.html (for consistency)
      function showNotifications() {
        alert("Notifications would appear here");
      }

      function showProfile() {
        const userData = JSON.parse(localStorage.getItem("cacUser")) || {};
        alert(
          `Profile Information:\n\nName: ${
            userData.fullName || "N/A"
          }\nEmail: ${userData.email || "N/A"}`
        );
      }

      // Load user documents from Firebase
      function loadUserDocuments(userEmail) {
        documentsRef
          .orderByChild("userId")
          .equalTo(userEmail)
          .once("value")
          .then((snapshot) => {
            if (snapshot.exists()) {
              const documents = snapshot.val();
              console.log("User documents loaded:", documents);

              // In a real app, you would populate the document lists with actual data
              // For now, we're using static data for demonstration

              // You could update the document list here with real data:
              updateDocumentList(documents);
            } else {
              console.log("No documents found for this user");
              // Show no documents message
              document.getElementById("noDocuments").style.display = "block";
              document.getElementById("allDocuments").style.display = "none";
            }
          })
          .catch((error) => {
            console.error("Error loading documents:", error);
          });
      }

      // Initialize the page
      document.addEventListener("DOMContentLoaded", function () {
        // Check if user is logged in
        const userData = JSON.parse(localStorage.getItem("cacUser"));
        if (!userData) {
          alert("Please log in to access this service");
          window.location.href = "registration.html";
          return;
        }

        // Load user documents from Firebase
        loadUserDocuments(userData.email);

        // Show all documents by default
        document.getElementById("allDocuments").style.display = "block";

        // Add click outside modal to close
        document
          .getElementById("paymentModal")
          .addEventListener("click", function (e) {
            if (e.target === this) {
              closePaymentModal();
            }
          });
      });
    </script>
  </body>
</html>
